<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8" />
	<title>MIDI Recorder</title>
	<meta name="viewport" content="width=device-width, initial-scale=1" />

	<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
	<link rel="manifest" href="/site.webmanifest">
	<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#d30000">
	<meta name="apple-mobile-web-app-title" content="MIDI Recorder">
	<meta name="application-name" content="MIDI Recorder">
	<meta name="msapplication-TileColor" content="#b91d47">
	<meta name="theme-color" content="#ff0">

	<link rel="stylesheet" href="lib/aria.modal.css" />
	<link rel="stylesheet" href="lib/inert-polyfill.css" />
	<link rel="stylesheet" href="app.css" />
</head>

<body>
	<!--
	outer centered layout with scrolling
		https://codepen.io/1j01/pen/KOKOMg
		based on https://stackoverflow.com/a/16127018/2624876
	-->
	<div class="outer-container">
	<div class="centering-container">
	<main class="app-main">
		<noscript>
			This app requires JavaScript.
		</noscript>
		<h2>Plug in a MIDI keyboard and play away!</h2>
		<div id="controls">
			<span class="visually-hidden">.</span> <!-- for screen readers, or at least ChromeVox -->
			<fieldset class="ui-section">
				<legend>Input</legend>
				<span class="visually-hidden">.</span> <!-- for screen readers, or at least ChromeVox -->
				<h3>MIDI devices:</h3>
				<div id="midi-devices-area">
					<p id="loading-midi-devices-message" hidden>Loading...</p>
					<p id="no-midi-devices-message" hidden>No MIDI devices detected</p>
					<table id="midi-devices" aria-live="assertive"></table>
					<div id="midi-not-supported" hidden>
						<div class="error-message">
							This browser doesn't support MIDI access.
							Try using Chrome, or for other browsers, the
							<a href="https://jazz-soft.net/download/web-midi/">Jazz-Soft Web MIDI API extension</a>.
						</div>
						<button class="button-functional" id="demo-button">
							<span class="button-visual">
								<span id="demo-button-stop-text" hidden>
									<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" height="1em">
										<polygon points="0,0 0,100 100,100 100,0" fill="#FFF" class="fill-cc"/>
									</svg>
									Stop Demo
								</span>
								<span id="demo-button-start-text">
									<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" height="1em">
										<polygon points="0,0 0,100 100,50" fill="#FFF" class="fill-cc"/>
									</svg>
									Demo
								</span>
							</span>
						</button>
					</div>
					<div id="midi-access-failed" class="error-message" hidden>
						Failed to get MIDI access.
						<pre id="midi-access-failed-pre"></pre>
					</div>
				</div>
				<button id="troubleshoot-midi-input-button" class="popover-button" aria-haspopup="dialog" aria-expanded="false">
					<svg fill="currentColor" height="1em" viewBox="0 0 40 40" style="vertical-align: bottom;">
						<path
							d="m18.4 15v-3.4h3.2v3.4h-3.2z m1.6 18.4c7.3 0 13.4-6.1 13.4-13.4s-6.1-13.4-13.4-13.4-13.4 6.1-13.4 13.4 6.1 13.4 13.4 13.4z m0-30c9.2 0 16.6 7.4 16.6 16.6s-7.4 16.6-16.6 16.6-16.6-7.4-16.6-16.6 7.4-16.6 16.6-16.6z m-1.6 25v-10h3.2v10h-3.2z">
						</path>
					</svg>
					<u>MIDI device not showing up?</u>
				</button>
				<div id="troubleshoot-midi-input-popover" class="popover" hidden>
					<ul class="bulleted-list">
						<li>Make sure it's plugged into your computer and turned on.</li>
						<li>Try <a href="JavaScript:location.reload();">refreshing the page</a>.</li>
						<li>If that doesn't work, try unplugging it and plugging it back in.</li>
						<li>Try restarting your computer.</li>
					</ul>
					<div class="popover-arrow" data-popper-arrow></div>
				</div>
			</fieldset>
			<fieldset id="midi-exporting" class="ui-section">
				<legend>Export</legend>
				<div id="midi-exporting-clearing-controls">
					<button class="button-functional" id="export-midi-file-button" disabled aria-keyshortcuts="Ctrl+S Meta+S">
						<span class="button-visual">
							<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" height="16">
								<g stroke-width="48.857" transform="translate(-3.631 -5.26) scale(.02225)">
									<path class="fill-cc" d="M301.429 312.422l372.684-76v103.929l-372.684 76z"/>
									<path class="fill-cc" d="M301.429 312.342h60v388.5h-60z"/>
									<ellipse class="fill-cc" cx="-165" cy="470.362" rx="125" ry="78" transform="matrix(.77274 -.20706 .24886 .92877 273.331 240.338)"/>
									<path class="fill-cc" d="M614.113 248.877h60v388.5h-60z"/>
									<ellipse class="fill-cc" cx="-165" cy="470.362" rx="125" ry="78" transform="matrix(.77274 -.20706 .24886 .92877 586.016 176.873)"/>
								</g>
								<path class="fill-cc" fill-rule="evenodd" d="M12.613 9.426c-.125.561-.347 1.012-1.258 1.585v1.165H9.033l3.485 3.838L16 12.176h-2.322v-2.75z"/>
							</svg>
							Save MIDI File
						</span>
					</button>
					<span id="name-or-message">
						<span id="no-notes-recorded-message" tabindex="0">&nbsp;- No notes recorded</span>
						<input type="text" id="recording-name-input" hidden/>
					</span>
					<span style="flex: 1"></span>
					<button class="button-functional" id="clear-button" disabled>
						<span class="button-visual">
							<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" height="1em">
								<path class="fill-cc" d="M39.294 63.922c-5.91-.629-11.383-2.047-16.826-4.362-1.553-.66-4.626-2.198-5.977-2.99-4.008-2.35-7.353-4.936-10.39-8.035-1.735-1.77-3.048-3.3-3.357-3.91-.179-.353-.194-.438-.194-1.068 0-.613.018-.722.177-1.046.253-.513.57-.856 1.008-1.09.475-.252.926-.324 2.336-.373 3.303-.113 6.816-.77 10.27-1.922 4.89-1.63 8.196-3.606 10.903-6.513.618-.663 1.02-1.184 1.91-2.475.359-.52.69-.953.69-.953l4.228 2.034s-1.344 2.408-2.02 3.307c-4.042 5.372-11.416 9.262-20.634 10.885-.538.095-1.033.195-1.101.222-.104.042-.01.155.62.743 1.15 1.075 4.54 3.748 4.994 3.94.338.141.788.103 1.687-.143 1.986-.544 3.686-1.4 5.189-2.614.564-.455.587-.438.266.204-.452.905-1.627 2.507-2.997 4.088-.333.384-.605.716-.605.738 0 .023.609.336 1.353.696.744.36 1.808.9 2.364 1.2 1.165.63 1.74.81 2.58.81 1.035 0 2.04-.292 3.53-1.023 2.286-1.122 4.338-2.58 7.467-5.306l.309-.268-.127.368c-.446 1.296-1.746 3.565-3.897 6.802-.626.944-1.129 1.726-1.116 1.738.14.134 6.29 1.275 6.87 1.275.363 0 .552-.184 1.181-1.147 2.265-3.465 4.403-7.518 6.223-11.797.612-1.438.874-2.117 1.927-4.981.48-1.306.9-2.712.921-2.733.021-.022 4.55 1.83 4.58 1.856.067.058-1.255 3.727-2.134 5.923-2.08 5.193-4.356 9.659-7.103 13.94-.827 1.289-1.915 2.807-2.283 3.187-.646.667-1.569.926-2.822.793z"/>
								<path class="fill-cc-if-disabled" fill="red" d="M43.467 30.744c-6.402-2.85-11.665-5.19-11.696-5.202-.08-.028.23-.628.663-1.282 1.021-1.545 2.807-2.714 4.856-3.178.674-.153 2.13-.153 2.852 0 .852.181 1.344.37 3.945 1.513 4.675 2.054 7.29 3.248 7.909 3.61a7.62 7.62 0 013.693 5.22c.13.69.132 1.969.002 2.715-.099.563-.474 1.789-.548 1.787-.02-.001-5.274-2.333-11.676-5.183z"/>
								<path class="fill-cc" d="M47.999 20.662c-2.008-.897-3.687-1.666-3.731-1.709-.063-.06.954-2.015 4.703-9.043C51.8 4.608 53.853.83 53.996.665c.382-.44.681-.565 1.339-.56a4 4 0 012.68 1.052c.494.457.71.89.71 1.421 0 .367-.296 1.221-3.45 9.925-3.1 8.556-3.56 9.805-3.61 9.793-.008-.002-1.658-.737-3.666-1.634z"/>
							</svg>
							Clear
						</span>
					</button>
					<button class="button-functional" id="undo-clear-button" hidden>
						<span class="button-visual">
							<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 511.983 511.983" height="1em">
								<path class="fill-cc" d="M255.983 160.199V63.986c-.007-5.891-4.788-10.661-10.679-10.655a10.666 10.666 0 00-5.983 1.844l-234.667 160c-4.866 3.321-6.119 9.957-2.798 14.823a10.667 10.667 0 002.798 2.798l234.667 160c4.873 3.311 11.507 2.045 14.817-2.828a10.674 10.674 0 001.844-5.983v-95.68c121.323 6.997 233.472 130.581 234.667 159.232v.619c.093 5.824 4.842 10.497 10.667 10.496 5.891 0 10.667-4.776 10.667-10.667v-.533c-2.133-118.122-91.946-280.469-256-287.253z"/>
							</svg>
							Undo Clear
						</span>
					</button>
				</div>
				<br>
				<div class="error-message" hidden id="recovery-error-message"></div>
				<!-- Modal libraries like to replace your buttons' id attributes apparently... -->
				<!-- Also there's no equivalent data-modal-hidden to make it not unhide the button if it's hidden -->
				<button class="button-functional show-recovery-button" disabled data-modal-disabled data-modal-open="recovery-modal-content">
					<span class="button-visual">
						<span class="loading-indicator"></span>
						Recover Recordings
					</span>
				</button>
				<div id="recovery-modal-content" hidden data-modal>
					<div data-modal-document>
						<h3>Recover Recordings</h3>
						<ul id="recoverables"></ul>
						<p id="recovery-empty-message" hidden>
							No more recordings to recover.
						</p>
					</div>
				</div>

			</fieldset>
			<!-- <div id="perspective-registration-container">
				<video id="perspective-registration-video">Video stream not available.</video>
				
				<svg id="perspective-registration-svg" viewBox="0 0 400 400" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
					<defs>
						<g id="point-handle">
							<circle
								r="10" x="0" y="0"
								stroke-width="2"
								fill="#000"
								fill-opacity="0.3"
								stroke="#fff"
							/>
							<line
								x1="0" y1="-10"
								x2="0" y2="10"
								stroke="white"
							/>
							<line
								x1="-10" y1="0"
								x2="10" y2="0"
								stroke="white"
							/>
						</g>
					</defs>
					<polygon
						id="perspective-registration-polygon"
						stroke="#29e"
						opacity="0.9"
						stroke-width="2"
						stroke-linejoin="round"
						fill="none"
						points="123,144 0,200 400,200 273,144"
					/>
				</svg> -->

				<div id="fullscreen-target">
					<canvas id="midi-viz-canvas" class="element-to-transform"></canvas>
				</div>
			<!-- </div> -->
		</div>
	</main>
	</div>
	</div>

	<div id="buttons-overlay-right" class="buttons-overlay">
		<a href="https://github.com/1j01/midi-recorder/" target="_blank" class="button-functional" id="github-button" style="text-decoration: none;">
			<span class="button-visual">
				<svg fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" height="1em"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
				<span class="text-label">GitHub</span>
			</span>
		</a>
	</div>

	<script src="lib/FileSaver.js"></script>
	<script src="lib/popper-2.11.5.js"></script>
	<script src="lib/aria.modal.js"></script>
	<script src="lib/inert-polyfill.js"></script>
	<script src="lib/SimpleMidiInput.js"></script>
	<script src="lib/midifile/MIDIEvents.js"></script>
	<script src="lib/midifile/MIDIFile.js"></script>
	<script>JZZ={MIDI:{noteValue(){}}}</script>
	<script src="lib/JZZ.midi.GM.js"></script>
	<script src="lib/localforage.js"></script>
	<!-- <script src="lib/interact.min.js"></script> -->
	<script src="compiled/app.js"></script>
	<!-- <script src="compiled/3d.js"></script> -->
</body>
</html>
